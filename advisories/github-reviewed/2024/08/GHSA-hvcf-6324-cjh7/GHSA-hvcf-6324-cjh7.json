{
  "schema_version": "1.4.0",
  "id": "GHSA-hvcf-6324-cjh7",
  "modified": "2024-08-14T18:08:19Z",
  "published": "2024-08-14T18:08:19Z",
  "aliases": [
    "CVE-2024-43369"
  ],
  "summary": "Persistent Cross-site Scripting in Ibexa RichText Field Type",
  "details": "### Impact\nThe validator for the RichText fieldtype blocklists `javascript:` and `vbscript:` in links to prevent XSS. This can leave other options open, and the check can be circumvented using upper case. Content editing permissions for RichText content is required to exploit this vulnerability, which typically means Editor role or higher. The fix implements an allowlist instead, which allows only approved link protocols. The new check is case insensitive.\n\n### Patches\n- See \"Patched versions\".\n- https://github.com/ibexa/fieldtype-richtext/commit/59e9c1a9da60597f60cf7338bf289dccaa7e27ca (and follow-up https://github.com/ibexa/fieldtype-richtext/commit/0a3b830e8806d5169f697351fdc48ffd95a25c67)\n\n### Workarounds\nNone.\n\n### References\n- Same issue in v3.3: https://github.com/ezsystems/ezplatform-richtext/security/advisories/GHSA-rhm7-7469-rcpw\n- Ibexa advisory: https://developers.ibexa.co/security-advisories/ibexa-sa-2024-005-persistent-xss-in-richtext\n\n### Credit\nThis vulnerability was discovered and reported to Ibexa by Alec Romano: https://github.com/4rdr\nWe thank them for reporting it responsibly to us.\n\nHow to report security issues:\nhttps://doc.ibexa.co/en/latest/infrastructure_and_maintenance/security/reporting_issues/",
  "severity": [

  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Packagist",
        "name": "ibexa/fieldtype-richtext"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "4.6.0"
            },
            {
              "fixed": "4.6.10"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/ezsystems/ezplatform-richtext/security/advisories/GHSA-rhm7-7469-rcpw"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ibexa/fieldtype-richtext/security/advisories/GHSA-hvcf-6324-cjh7"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ibexa/fieldtype-richtext/commit/0a3b830e8806d5169f697351fdc48ffd95a25c67"
    },
    {
      "type": "WEB",
      "url": "https://github.com/ibexa/fieldtype-richtext/commit/59e9c1a9da60597f60cf7338bf289dccaa7e27ca"
    },
    {
      "type": "WEB",
      "url": "https://developers.ibexa.co/security-advisories/ibexa-sa-2024-005-persistent-xss-in-richtext"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/ibexa/fieldtype-richtext"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-79"
    ],
    "severity": "HIGH",
    "github_reviewed": true,
    "github_reviewed_at": "2024-08-14T18:08:19Z",
    "nvd_published_at": null
  }
}