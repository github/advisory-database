{
  "schema_version": "1.4.0",
  "id": "GHSA-7v7m-pcw5-h3cg",
  "modified": "2024-05-20T17:49:10Z",
  "published": "2024-05-20T17:49:10Z",
  "aliases": [

  ],
  "summary": " Pusher Service Channel Authentication Bypass",
  "details": "The service offered by Pusher provides \"private\" channels with an authentication mechanism that restricts subscription access. The decision on allowing subscriptions to private channels is delegated to customers, who implement an authentication endpoint. End-users request a token from this endpoint to join a specific channel. The token is an HMAC signature of the end-user's connection ID (socket_id) and the desired channel.\n\nThe issue arises from a lack of validation in the libraries provided to customers. This vulnerability allows a malicious end-user to submit a malformed socket_id field, leading the customer to unknowingly sign a string. This signed string grants access to a different private channel than the one the end-user is ostensibly requesting. Consequently, a malicious end-user, with permission to subscribe to one private channel, can forge permission for any private channel owned by the same customer.\n\nAdditionally, the HTTP API is secured by requiring a signature with each request, generated by the customer's secret key. In specific cases, a malicious end-user may deceive a customer into signing a value for socket_id, effectively authenticating an API request to Pusher.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Packagist",
        "name": "pusher/pusher-php-server"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.2.1"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/pusher/pusher-http-php/commit/5a2ccdd3b14932b9cb5d0f59cf81d19c447214f1"
    },
    {
      "type": "WEB",
      "url": "https://blog.pusher.com/update-on-security"
    },
    {
      "type": "WEB",
      "url": "https://github.com/FriendsOfPHP/security-advisories/blob/master/pusher/pusher-php-server/2015-05-13.yaml"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/pusher/pusher-http-php"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-74"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2024-05-20T17:49:10Z",
    "nvd_published_at": null
  }
}