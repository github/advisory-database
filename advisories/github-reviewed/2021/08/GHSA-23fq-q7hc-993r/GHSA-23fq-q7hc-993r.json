{
  "schema_version": "1.2.0",
  "id": "GHSA-23fq-q7hc-993r",
  "modified": "2022-07-17T07:52:22Z",
  "published": "2021-08-30T17:22:53Z",
  "aliases": [
    "CVE-2021-38553"
  ],
  "summary": "Improper Preservation of Permissions in HashiCorp Vault",
  "details": "HashiCorp Vault and Vault Enterprise 1.4.0 through 1.7.3 initialized an underlying database file associated with the Integrated Storage feature with excessively broad filesystem permissions. Fixed in Vault and Vault Enterprise 1.8.0.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/hashicorp/vault"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "1.4.0"
            },
            {
              "fixed": "1.8.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-38553"
    },
    {
      "type": "WEB",
      "url": "https://discuss.hashicorp.com/t/hcsec-2021-20-vault-s-integrated-storage-backend-database-file-may-have-excessively-broad-permissions/28168"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/hashicorp/vault/"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-281"
    ],
    "severity": "CRITICAL",
    "github_reviewed": true
  }
}