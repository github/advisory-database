{
  "schema_version": "1.3.0",
  "id": "GHSA-rvgf-69j7-xh78",
  "modified": "2022-07-05T21:23:15Z",
  "published": "2022-06-18T00:00:20Z",
  "aliases": [
    "CVE-2022-25345"
  ],
  "summary": "Uncontrolled Resource Consumption in @discordjs/opus",
  "details": "Improperly handled errors in @discordjs/opus cause hard crashes instead of returning the error to user land.\", \"details\": \"All versions of package @discordjs/opus (<= 0.7.0) are vulnerable to Denial of Service (DoS) when trying to encode using an encoder with zero channels, or a non-initialized buffer. This leads to a hard crash due to improperly returning the errors from the invalid inputs.\n\nAs of version 0.8.0, the errors are correctly returned to the user and are no longer throwing hard crashes that cannot be recovered.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "npm",
        "name": "@discordjs/opus"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.8.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-25345"
    },
    {
      "type": "WEB",
      "url": "https://github.com/discordjs/opus/commit/406249f3fca484a2af97a34ceb989019efa09bc7"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/discordjs/opus"
    },
    {
      "type": "WEB",
      "url": "https://github.com/discordjs/opus/blob/3ca4341ffdd81cf83cec57045e59e228e6017590/src/node-opus.cc#L28"
    },
    {
      "type": "WEB",
      "url": "https://github.com/discordjs/opus/releases/tag/v0.8.0"
    },
    {
      "type": "WEB",
      "url": "https://snyk.io/vuln/SNYK-JS-DISCORDJSOPUS-2403100"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-908"
    ],
    "severity": "HIGH",
    "github_reviewed": true
  }
}