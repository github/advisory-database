{
  "schema_version": "1.3.0",
  "id": "GHSA-4whx-7p29-mq22",
  "modified": "2022-06-06T21:22:28Z",
  "published": "2022-06-06T21:22:28Z",
  "aliases": [
    "CVE-2022-31011"
  ],
  "summary": "TiDB authentication bypass vulnerability",
  "details": "### Impact\nUnder certain conditions, an attacker can construct malicious authentication requests to bypass the authentication process, resulting in privilege escalation or unauthorized access.\nOnly users using TiDB 5.3.0 are affected by this vulnerability.\n\n### Patches\nPlease upgrade to TiDB 5.3.1 or higher version\n\n### Workarounds\nYou can also mitigate risks by taking the following measures.\nOption 1: Turn off SEM (Security Enhanced Mode).\nOption 2: Disable local login for non-root accounts and ensure that the same IP cannot be logged in as root or normal user at the same time.\n\n### References\nhttps://en.pingcap.com/download/\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at security@tidb.io\n",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/pingcap/tidb"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "5.3.0"
            },
            {
              "fixed": "5.3.1"
            }
          ]
        }
      ],
      "versions": [
        "5.3.0"
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/pingcap/tidb/security/advisories/GHSA-4whx-7p29-mq22"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-31011"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/pingcap/tidb"
    },
    {
      "type": "WEB",
      "url": "https://github.com/pingcap/tidb/releases/tag/v5.3.1"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-287"
    ],
    "severity": "HIGH",
    "github_reviewed": true
  }
}